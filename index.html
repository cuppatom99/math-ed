<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ham's Math Crunch</title>
    <style>
        :root {
            --black: #000000;
            --white: #ffffff;
            --cream: #fcf7f2;
            --purple: #3d1f6e;
            --orange: #f2631a;
            --blue: #54baf7;
            --yellow: #ffd447;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--orange);
            color: var(--black);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        .game-card {
            background: var(--white);
            padding: 2rem;
            border-radius: 30px;
            box-shadow: 15px 15px 0px var(--black);
            border: 4px solid var(--black);
            max-width: 450px;
            width: 90%;
            text-align: center;
        }

        .logo { width: 80px; margin-bottom: 10px; }

        .target-box {
            background: var(--purple);
            color: var(--white);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 3px solid var(--black);
        }

        .target-number { font-size: 4rem; font-weight: 900; display: block; }
        .target-label { text-transform: uppercase; font-size: 0.8rem; letter-spacing: 2px; }

        .slots {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 25px;
            min-height: 60px;
        }

        .slot {
            width: 50px;
            height: 60px;
            border: 3px dashed #ccc;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            background: var(--cream);
        }

        .slot.filled { border-style: solid; border-color: var(--black); }

        .inventory {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            background: var(--cream);
            padding: 15px;
            border-radius: 20px;
            border: 2px solid var(--black);
        }

        .item {
            padding: 12px 18px;
            background: var(--white);
            border: 2px solid var(--black);
            border-radius: 10px;
            cursor: pointer;
            font-weight: 900;
            font-size: 1.2rem;
            box-shadow: 0 4px 0 var(--black);
            transition: 0.1s;
        }

        .item:active { transform: translateY(4px); box-shadow: 0 0 0 var(--black); }
        .item.symbol { background: var(--yellow); }
        .item.number { background: var(--blue); color: var(--white); }

        .timer-container {
            width: 100%;
            height: 15px;
            background: var(--cream);
            border: 2px solid var(--black);
            border-radius: 10px;
            margin-top: 20px;
            overflow: hidden;
        }

        #timer-bar {
            width: 100%;
            height: 100%;
            background: var(--blue);
            transition: width 0.1s linear;
        }

        .controls { margin-top: 20px; display: flex; gap: 10px; }
        button {
            flex: 1;
            padding: 10px;
            border-radius: 50px;
            border: 3px solid var(--black);
            font-weight: 900;
            cursor: pointer;
            text-transform: uppercase;
        }
        #clear-btn { background: var(--cream); }
        #next-btn { background: var(--yellow); display: none; }
    </style>
</head>
<body>

<div class="game-card">
    <img src="https://raw.githubusercontent.com/cuppatom99/toastie-picker/main/Ham.png" class="logo" alt="Ham Logo">
    
    <div class="target-box">
        <span class="target-label">Target Number</span>
        <span id="target-val" class="target-number">??</span>
    </div>

    <div class="slots" id="slots">
        <div class="slot" data-index="0"></div>
        <div class="slot" data-index="1"></div>
        <div class="slot" data-index="2"></div>
        <div class="slot" data-index="3"></div>
        <div class="slot" data-index="4"></div>
    </div>

    <div class="inventory" id="inventory">
        </div>

    <div class="timer-container">
        <div id="timer-bar"></div>
    </div>

    <div class="controls">
        <button id="clear-btn">Clear</button>
        <button id="next-btn">Next Level</button>
    </div>
</div>

<script>
    let targetNum, solution;
    let currentInput = [];
    let timeLeft = 100;
    let timerInterval;

    const slotElements = document.querySelectorAll('.slot');
    const invElement = document.getElementById('inventory');
    const targetDisplay = document.getElementById('target-val');
    const timerBar = document.getElementById('timer-bar');

    function initGame() {
        clearInterval(timerInterval);
        currentInput = [];
        timeLeft = 100;
        updateSlots();
        
        // Generate a random solvable equation: (A op B) op C
        const n1 = Math.floor(Math.random() * 10) + 1;
        const n2 = Math.floor(Math.random() * 10) + 1;
        const n3 = Math.floor(Math.random() * 10) + 1;
        const n4 = Math.floor(Math.random() * 10) + 1; // Decoy
        const ops = ['+', '-', '*'];
        const op1 = ops[Math.floor(Math.random() * ops.length)];
        const op2 = ops[Math.floor(Math.random() * ops.length)];

        const equation = `(${n1}${op1}${n2})${op2}${n3}`;
        targetNum = eval(equation);

        // If target is negative or too big, retry
        if (targetNum < 0 || targetNum > 99) return initGame();

        targetDisplay.innerText = targetNum;

        // Shuffle numbers and symbols for inventory
        const items = [
            {val: n1, type: 'number'}, {val: n2, type: 'number'}, 
            {val: n3, type: 'number'}, {val: n4, type: 'number'},
            {val: '+', type: 'symbol'}, {val: '-', type: 'symbol'}, 
            {val: '*', type: 'symbol'}, {val: '/', type: 'symbol'}
        ].sort(() => Math.random() - 0.5);

        invElement.innerHTML = '';
        items.forEach(item => {
            const div = document.createElement('div');
            div.className = `item ${item.type}`;
            div.innerText = item.val;
            div.onclick = () => addToSlot(item.val);
            invElement.appendChild(div);
        });

        startTimer();
        document.getElementById('next-btn').style.display = 'none';
    }

    function addToSlot(val) {
        if (currentInput.length < 5) {
            currentInput.push(val);
            updateSlots();
            checkResult();
        }
    }

    function updateSlots() {
        slotElements.forEach((s, i) => {
            s.innerText = currentInput[i] || '';
            s.className = currentInput[i] ? 'slot filled' : 'slot';
        });
    }

    function checkResult() {
        if (currentInput.length === 5) {
            try {
                // Formatting for eval: (N1 OP N2) OP N3
                const exp = `(${currentInput[0]}${currentInput[1]}${currentInput[2]})${currentInput[3]}${currentInput[4]}`;
                if (eval(exp) === targetNum) {
                    clearInterval(timerInterval);
                    targetDisplay.innerText = "WIN!";
                    document.getElementById('next-btn').style.display = 'block';
                }
            } catch (e) { /* Invalid math, wait for clear */ }
        }
    }

    function startTimer() {
        timerInterval = setInterval(() => {
            timeLeft -= 0.5;
            timerBar.style.width = timeLeft + "%";
            if (timeLeft <= 0) {
                clearInterval(timerInterval);
                targetDisplay.innerText = "LOSE";
                document.getElementById('next-btn').style.display = 'block';
            }
        }, 100);
    }

    document.getElementById('clear-btn').onclick = () => {
        currentInput = [];
        updateSlots();
    };

    document.getElementById('next-btn').onclick = initGame;

    initGame();
</script>

</body>
</html>
